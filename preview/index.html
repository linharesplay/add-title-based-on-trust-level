<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Preview - Titulo com Barra de Progresso</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: #1a1a2e;
      color: #e0e0e0;
      min-height: 100vh;
      padding: 32px;
    }

    h1 {
      font-size: 22px;
      font-weight: 700;
      color: #fff;
      margin-bottom: 8px;
    }
    .subtitle {
      font-size: 14px;
      color: #8a8aa0;
      margin-bottom: 32px;
    }

    .section-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: #6c6c8a;
      margin-bottom: 16px;
      margin-top: 32px;
    }

    .post-card {
      background: #16213e;
      border: 1px solid #1f3460;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      display: flex;
      gap: 16px;
      transition: border-color 0.2s;
    }
    .post-card:hover {
      border-color: #3a5ba0;
    }

    .avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 700;
      color: #fff;
    }

    .post-content { flex: 1; }

    .post-header {
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 4px;
      flex-wrap: wrap;
    }

    .username {
      font-weight: 700;
      font-size: 15px;
      color: #fff;
    }

    .user-title {
      font-size: 12px;
      color: #8a8aa0;
      background: #1f3460;
      border-radius: 4px;
      padding: 2px 8px;
      font-family: "SF Mono", "Fira Code", "Cascadia Code", monospace;
      letter-spacing: 0.3px;
    }

    .progress-part {
      color: #4fc3f7;
      white-space: nowrap;
    }

    .post-time {
      font-size: 12px;
      color: #555;
      margin-left: auto;
    }

    .post-body {
      font-size: 14px;
      line-height: 1.6;
      color: #c0c0d0;
    }

    .tl-badge {
      display: inline-block;
      font-size: 10px;
      font-weight: 700;
      padding: 2px 6px;
      border-radius: 4px;
      margin-left: 4px;
      vertical-align: middle;
    }
    .tl-0 { background: #333; color: #aaa; }
    .tl-1 { background: #1b5e20; color: #a5d6a7; }
    .tl-2 { background: #0d47a1; color: #90caf9; }
    .tl-3 { background: #e65100; color: #ffcc80; }
    .tl-4 { background: #b71c1c; color: #ef9a9a; }

    .controls {
      background: #16213e;
      border: 1px solid #1f3460;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
    }
    .controls label {
      display: block;
      font-size: 13px;
      color: #c0c0d0;
      margin-bottom: 8px;
    }
    .slider-row {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }
    .slider-row input[type="range"] {
      flex: 1;
      accent-color: #4fc3f7;
    }
    .slider-value {
      font-family: "SF Mono", monospace;
      font-size: 14px;
      color: #4fc3f7;
      min-width: 40px;
      text-align: right;
    }

    .legend {
      background: #16213e;
      border: 1px solid #1f3460;
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 24px;
      font-size: 13px;
      color: #8a8aa0;
      line-height: 1.8;
    }
    .legend code {
      background: #1f3460;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: "SF Mono", monospace;
      font-size: 12px;
      color: #4fc3f7;
    }
  </style>
</head>
<body>

  <h1>Preview: Titulo com Barra de Progresso</h1>
  <p class="subtitle">Visualize como o titulo com barra de progresso aparece nos posts do Discourse</p>

  <div class="legend">
    <strong>Como funciona:</strong> O plugin calcula a media de progresso dos requisitos do proximo trust level
    (topicos lidos, posts lidos, dias visitados, likes, etc.) e gera uma barra com caracteres Unicode:<br/>
    <code>█</code> = preenchido &nbsp; <code>░</code> = vazio &nbsp; Formato: <code>[██████░░░░] 60%</code>
  </div>

  <div class="controls">
    <label><strong>Ajuste o progresso interativamente:</strong></label>
    <div class="slider-row">
      <span style="font-size:13px;color:#c0c0d0;">Progresso para TL1:</span>
      <input type="range" id="slider-tl0" min="0" max="100" value="35" oninput="updateAll()" />
      <span class="slider-value" id="val-tl0">35%</span>
    </div>
    <div class="slider-row">
      <span style="font-size:13px;color:#c0c0d0;">Progresso para TL2:</span>
      <input type="range" id="slider-tl1" min="0" max="100" value="72" oninput="updateAll()" />
      <span class="slider-value" id="val-tl1">72%</span>
    </div>
    <div class="slider-row">
      <span style="font-size:13px;color:#c0c0d0;">Progresso para TL3:</span>
      <input type="range" id="slider-tl2" min="0" max="100" value="15" oninput="updateAll()" />
      <span class="slider-value" id="val-tl2">15%</span>
    </div>
    <div class="slider-row">
      <span style="font-size:13px;color:#c0c0d0;">Progresso para TL4:</span>
      <input type="range" id="slider-tl3" min="0" max="100" value="90" oninput="updateAll()" />
      <span class="slider-value" id="val-tl3">90%</span>
    </div>
  </div>

  <div class="section-label">Exemplo de posts no Discourse</div>

  <div id="posts"></div>

  <script>
    const FILLED = '\u2588';
    const EMPTY  = '\u2591';
    const BAR_LEN = 10;

    function makeBar(pct) {
      const filled = Math.round((pct / 100) * BAR_LEN);
      const empty = BAR_LEN - filled;
      return `[${FILLED.repeat(filled)}${EMPTY.repeat(empty)}] ${pct}%`;
    }

    const users = [
      { name: 'Carlos Silva', initials: 'CS', color: '#e91e63', tl: 0, titleBase: 'Novato', group: null, slider: 'slider-tl0' },
      { name: 'Ana Pereira', initials: 'AP', color: '#4caf50', tl: 1, titleBase: 'Membro', group: 'Moderadores', slider: 'slider-tl1' },
      { name: 'Bruno Costa', initials: 'BC', color: '#2196f3', tl: 2, titleBase: 'Regular', group: null, slider: 'slider-tl2' },
      { name: 'Maria Souza', initials: 'MS', color: '#ff9800', tl: 3, titleBase: 'Veterano', group: 'Staff', slider: 'slider-tl3' },
      { name: 'Admin Jose', initials: 'AJ', color: '#f44336', tl: 4, titleBase: 'Lider', group: 'Admins', slider: null },
    ];

    const postBodies = [
      'Oi pessoal! Acabei de entrar no forum, como funciona aqui?',
      'Muito bom esse topico! Recomendo tambem dar uma olhada na documentacao oficial.',
      'Concordo com a Ana. Alem disso, acho que deveriamos criar uma categoria separada para isso.',
      'Galera, atualizei as regras da comunidade. Por favor leiam antes de postar.',
      'Parabens a todos pelo engajamento este mes! Vamos continuar assim.',
    ];

    function updateAll() {
      const container = document.getElementById('posts');
      container.innerHTML = '';

      users.forEach((u, i) => {
        const pct = u.slider ? parseInt(document.getElementById(u.slider).value) : null;
        if (u.slider) {
          document.getElementById(`val-${u.slider.replace('slider-', '')}`).textContent = `${pct}%`;
        }

        let titleText = u.group ? `${u.titleBase} - ${u.group}` : u.titleBase;
        const progressBar = (pct !== null && u.tl < 4) ? makeBar(pct) : null;
        const titleHtml = progressBar
          ? `${titleText} <span class="progress-part">${progressBar}</span>`
          : titleText;

        const card = document.createElement('div');
        card.className = 'post-card';
        card.innerHTML = `
          <div class="avatar" style="background:${u.color}">${u.initials}</div>
          <div class="post-content">
            <div class="post-header">
              <span class="username">${u.name}</span>
              <span class="tl-badge tl-${u.tl}">TL${u.tl}</span>
              <span class="user-title">${titleHtml}</span>
            </div>
            <div class="post-body">${postBodies[i]}</div>
          </div>
        `;
        container.appendChild(card);
      });
    }

    updateAll();
  </script>

</body>
</html>
